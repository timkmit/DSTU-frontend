import{u as w,a as s,j as e,P as k,T as E,B as q}from"./index-B9-aZz-R.js";import{T as i}from"./TextField-CG6ONMtj.js";const R=()=>{w();const[l,j]=s.useState(""),[h,p]=s.useState([]),[o,g]=s.useState(""),[c,b]=s.useState(""),[r,f]=s.useState(0),[d,y]=s.useState(""),[u,N]=s.useState(""),[v,S]=s.useState(""),[m,x]=s.useState(!1);s.useEffect(()=>{const t=setTimeout(()=>{l?(x(!0),fetch(`https://pepper-coding.online/get_events?city=${l}`).then(a=>a.json()).then(a=>{p(a),x(!1)}).catch(a=>{console.error("Ошибка получения мероприятий:",a),x(!1)})):p([])},1e3);return()=>clearTimeout(t)},[l]);const C=async t=>{if(t.preventDefault(),!o||!c||r===0||!d||!u){alert("Все поля должны быть заполнены!");return}const a={event_id:o,author:c,rating:r,positive_comment:d,negative_comment:u,additionally:v};try{await fetch(`https://pepper-coding.online/review_event?city=${l}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}),alert("Отзыв успешно отправлен!")}catch(n){console.error(n),alert("Ошибка при отправке отзыва.")}},T=({currentRating:t,onRate:a})=>e.jsx("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(n=>e.jsx("span",{className:`cursor-pointer text-2xl ${n<=t?"text-yellow-500":"text-gray-400"}`,onClick:()=>a(n),children:"★"},n))});return e.jsx("div",{className:"max-w-[700px] w-full mx-auto p-4",children:e.jsxs(k,{className:"flex-1 flex flex-col p-2",children:[e.jsx(E.Title,{as:"h3",className:"m-2",children:"Оставить отзыв о мероприятии"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"city",className:"block mb-1",children:"Город"}),e.jsx(i,{id:"city",value:l,onChange:t=>j(t.target.value),label:"Введите город",required:!0})]}),l&&m&&e.jsx("p",{children:"Загрузка мероприятий..."}),h.length>0&&!m?e.jsxs("form",{onSubmit:C,className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"event",className:"block mb-1",children:"Выберите мероприятие"}),e.jsxs("select",{id:"event",value:o,onChange:t=>g(t.target.value),className:"w-full p-2 border border-gray-300 rounded",required:!0,children:[e.jsx("option",{value:"",children:"Выберите мероприятие"}),h.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"author",className:"block mb-1",children:"Выберите, кем вы являетесь"}),e.jsxs("select",{id:"author",value:c,onChange:t=>b(t.target.value),className:"w-full p-2 border border-gray-300 rounded",required:!0,children:[e.jsx("option",{value:"",children:"Выберите роль"}),e.jsx("option",{value:"Студент",children:"Студент"}),e.jsx("option",{value:"Преподаватель",children:"Преподаватель"}),e.jsx("option",{value:"Посетитель",children:"Посетитель"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Оценка мероприятия"}),e.jsx(T,{currentRating:r,onRate:t=>f(t)}),r===0&&e.jsx("p",{className:"text-red-500 text-sm",children:"Выберите оценку"})]}),e.jsx(i,{label:"Больше всего понравилось",value:d,onChange:t=>y(t.target.value),required:!0}),e.jsx(i,{label:"Меньше всего понравилось",value:u,onChange:t=>N(t.target.value),required:!0}),e.jsx(i,{label:"Дополнительный комментарий",value:v,onChange:t=>S(t.target.value)}),e.jsx(q,{type:"submit",children:"Отправить отзыв"})]}):!m&&l&&e.jsx("p",{className:"text-center text-gray-500",children:"Мероприятия в данном городе не найдены."})]})})};export{R as default};
